{% extends './Navbar/Navbar.twig' %}

{% block content %}

    <div class="max-w-7xl mx-auto p-8 space-y-10">
        <!-- Заголовок -->
        <div class="text-center">
            <h1 class="text-3xl font-bold text-gray-800 mb-2">Кабинет поставщика</h1>
            <p class="text-gray-500 text-sm mb-2">Управляйте своими финансами, компаниями и операциями</p>

            <!-- Имя поставщика -->
            <div class="text-lg font-semibold text-gray-700">
                {{ supplier.name }}
            </div>
        </div>

        <!-- === Новый блок: Управление поставщиком === -->
        <div class="bg-white shadow-sm rounded-2xl p-6 border border-gray-100 mt-8">
            <h2 class="text-2xl font-semibold text-gray-800 mb-6 flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg"
                     viewBox="0 0 24 24"
                     fill="none"
                     stroke="currentColor"
                     stroke-width="2.25"
                     stroke-linecap="round"
                     stroke-linejoin="round"
                     class="w-6 h-6 text-emerald-600"
                     aria-hidden="true">
                    <path d="M8.25 18.75a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h6m-9 0H3.375a1.125 1.125 0 0 1-1.125-1.125V14.25m17.25 4.5a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h1.125c.621 0 1.129-.504 1.09-1.124a17.902 17.902 0 0 0-3.213-9.193 2.056 2.056 0 0 0-1.58-.86H14.25M16.5 18.75h-2.25m0-11.177v-.958c0-.568-.422-1.048-.987-1.106a48.554 48.554 0 0 0-10.026 0 1.106 1.106 0 0 0-.987 1.106v7.635m12-6.677v6.677m0 4.5v-4.5m0 0h-12" />
                </svg>
                Финансы поставщика
            </h2>

            <div class="flex items-center justify-center gap-4 flex-wrap">
                <!-- Сумма долгов -->
                <div class="flex flex-col items-center p-4 bg-emerald-50 border border-emerald-200 rounded-xl shadow-sm">
                    <div class="text-sm text-gray-500">Долг перед компанией</div>
                    <div class="text-lg font-bold text-emerald-600">{{ debts.supplier_goods|number_format(0, ',', ' ') }} ₽</div>
                </div>

                <!-- Даты "ОТ- ДО-" в одну линию с инпутами -->
                <div class="flex items-center gap-2">
                    <!-- Дата "от" -->
                    <label class="text-sm font-medium text-gray-600">ОТ-</label>
                    <input id="from" type="text" placeholder="Дата начала" autocomplete="off" readonly
                           class="datepicker_from w-40 h-10 p-2 bg-white rounded-lg border border-gray-200 text-sm font-semibold text-gray-700 shadow-sm cursor-pointer"/>

                    <!-- Дата "до" -->
                    <label class="text-sm font-medium text-gray-600 ml-2">ДО-</label>
                    <input id="to" type="text" placeholder="Дата окончания" autocomplete="off" readonly
                           class="datepicker_to w-40 h-10 p-2 bg-white rounded-lg border border-gray-200 text-sm font-semibold text-gray-700 shadow-sm cursor-pointer"/>
                </div>

                <!-- Кнопка "Все отправки" -->
                <div class="search-sending-to-supplier flex flex-col">
                    <button type="button"
                            class="bg-emerald-600 hover:bg-emerald-700 text-white font-semibold py-2 px-4 rounded-lg shadow-sm transition-colors duration-200 h-10">
                        Все отправки
                    </button>
                </div>
            </div>
            <div class="w-full max-w-5xl mx-auto px-4 my-8">
                <ul class="list bg-base-100 rounded-lg shadow-md space-y-4">
                            <li class="relative p-4 bg-base-200 rounded-lg">

                                <!-- Указать сумму -->
                                <div x-data="{
                                        entered: '',
                                        get status() {
                                            if (!this.entered) return 'ok';
                                            if (isNaN(this.entered)) return 'invalid';
                                            return 'ok';
                                        }
                                    }" class="flex items-center gap-3 mb-4">

                            <input id="balance" type="text" x-model="entered"
                                   :class="status === 'invalid'
                            ? 'border border-red-500 text-red-500 bg-white'
                            : 'border border-green-500 text-green-700 bg-white'"
                                   class="h-12 w-40 px-3 rounded-lg focus:outline-none transition-colors duration-200"
                                   placeholder="Введите сумму">

                            <div class="text-sm mt-1 text-red-500"
                                 x-text="status === 'invalid' ? 'Введите число!' : ''"></div>
                        </div>

                        <!-- Дата -->
                        <div class="flex flex-col gap-2 mb-4">
                            <input
                                    type="text"
                                    id="date_input_stokc"
                                    placeholder="Выберите дату"
                                    autocomplete="off"
                                    readonly
                                    class="
                                        datepicker_from_stock
                                        w-full max-w-[280px]
                                        h-12 sm:h-[46px]
                                        px-4
                                        rounded-xl
                                        bg-white
                                        font-semibold text-green-700
                                        border border-green-500
                                        shadow-sm
                                        cursor-pointer
                                        focus:outline-none
                                    "
                            />
                        </div>

                        <!-- Выбор передачи -->
                        <div x-data="{ selected: null, openCourierList: false, selectedCourier: null }" class="space-y-4">

                            <!-- Закрыть долг компании -->
                            <div class="flex items-center gap-2">
                                <input type="radio" id="radio_debt" name="delivery_type" value="debt"
                                       class="hidden peer/debt" x-model="selected">
                                <label for="radio_debt"
                                       class="w-48 h-12 flex items-center justify-center border rounded-xl cursor-pointer
                                               bg-white text-green-700
                                               peer-checked/debt:bg-emerald-600 peer-checked/debt:text-white
                                               hover:peer-checked/debt:bg-emerald-700 transition">
                                    Закрыть долг компании
                                </label>
                            </div>

                            <!-- Передать курьеру -->
                            <div class="flex items-center gap-2">
                                <input type="radio" id="radio_courier" name="delivery_type" value="courier"
                                       class="hidden peer/courier" x-model="selected">
                                <label for="radio_courier"
                                       class="w-48 h-12 flex items-center justify-center border rounded-xl cursor-pointer
                                               bg-white text-green-700
                                               peer-checked/courier:bg-emerald-600 peer-checked/courier:text-white
                                               hover:peer-checked/courier:bg-emerald-700 transition">
                                    Передать курьеру
                                </label>

                                <div class="relative" x-show="selected === 'courier'" x-transition>
                                    {% if couriers is empty %}
                                        <a href="javascript:void(0)"
                                           class="w-80 h-12 flex items-center justify-center border rounded-xl px-4 bg-white text-green-700 border-green-500 cursor-not-allowed">
                                            Курьеры отсутствуют
                                        </a>
                                    {% else %}
                                        <button @click="openCourierList = !openCourierList"
                                                class="w-80 h-12 flex items-center justify-between border rounded-xl px-4 bg-white text-green-700 border-green-500 hover:bg-green-50 transition">
                                            <template x-if="!selectedCourier">
                                                <span>Выберите курьера</span>
                                            </template>
                                            <template x-if="selectedCourier">
                                                <span x-text="selectedCourier.name"></span>
                                            </template>
                                            <svg class="w-4 h-4 ml-2 text-green-600" fill="none" stroke="currentColor"
                                                 stroke-width="2" viewBox="0 0 24 24">
                                                <path d="M19 9l-7 7-7-7"/>
                                            </svg>
                                        </button>

                                        <input type="hidden" name="courier_id" :value="selectedCourier?.id">
                                        <input type="hidden" name="courier_name" :value="selectedCourier?.name">

                                        <div x-show="openCourierList"
                                             @click.outside="openCourierList = false"
                                             class="absolute mt-2 w-80 z-50 bg-white border border-green-200 rounded-xl shadow-sm p-2 space-y-1 transition duration-200">
                                            {% for courier in couriers %}
                                                <div @click="selectedCourier = { id: {{ courier.id }}, name: '{{ courier.name }}' }; openCourierList = false"
                                                     class="cursor-pointer px-4 py-2 rounded-md hover:bg-green-50 transition text-sm flex flex-col">
                                                    <span class="font-medium text-green-700">{{ courier.name }}</span>
                                                </div>
                                            {% endfor %}
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>

                        <!-- Комментарий -->
                        <div class="mt-4">
                            <label class="block text-sm font-medium text-green-800 mb-1">Комментарий</label>
                            <textarea id="comments"
                                      autocomplete="off"
                                      data-lpignore="true"
                                      class="textarea textarea-bordered w-full border-green-500"
                                      rows="3" maxlength="256"
                                      placeholder="Введите комментарий..."></textarea>
                        </div>

                        <!-- Сохранить -->
                        <div class="text-right mt-4">
                            <button id="save_expense"
                                    class="bg-emerald-600 hover:bg-emerald-700 text-white font-semibold py-2 px-6 rounded-lg transition-colors duration-200 w-full shadow-sm">
                                Сохранить
                            </button>
                        </div>
                    </li>
                </ul>
            </div>
        </div>

        <!-- Раздел: Транзит (Клиентские услуги) -->
        {% if no_managers is not empty %}
            <div class="bg-white shadow-sm rounded-2xl p-4 sm:p-6 border border-gray-100 mt-8">
                <h2 class="text-xl sm:text-2xl font-semibold text-gray-800 mb-4 sm:mb-6">
                    Транзит <span class="text-gray-500 text-base sm:text-lg">(клиентские услуги)</span>
                </h2>

                <div class="overflow-x-auto">
                    <table class="min-w-full text-xs sm:text-sm text-left border-t border-gray-200 table-auto">
                        <thead class="bg-gray-50 text-gray-700">
                            <tr class="border-b">
                                <th class="py-2 px-2 sm:px-4 font-medium">Дата</th>
                                <th class="py-2 px-2 sm:px-4 font-medium">Компания</th>
                                <th class="py-2 px-2 sm:px-4 font-medium w-72 sm:w-80 break-words">Назначение</th>
                                <th class="py-2 px-2 sm:px-4 font-medium w-28 sm:w-36 text-right hidden sm:table-cell">Сумма (₽)</th>
                                <th class="py-2 px-2 sm:px-4 font-medium w-40 sm:w-48 hidden sm:table-cell">Менеджер</th>
                            </tr>
                        </thead>

                        <tbody class="text-gray-700">
                        {% for item in no_managers %}
                            <tr class="hover:bg-gray-50 transition align-top flex flex-col sm:table-row mb-2 sm:mb-0">
                                <td class="py-2 px-2 sm:px-4">{{ item.date|date('d.m.Y') }}</td>
                                <td class="py-2 px-2 sm:px-4">{{ item.company_name }}</td>
                                <td class="py-2 px-2 sm:px-4 w-72 sm:w-80 break-words">{{ item.description }}</td>
                                <td class="py-2 px-2 sm:px-4 font-semibold text-green-600 text-right sm:text-right">
                                    {{ item.amount|number_format(0, ',', ' ') }} ₽
                                </td>
                                <td class="py-2 px-2 sm:px-4">
                                    <select class="select select-sm w-full border border-gray-300 pl-1" data-legal-id="{{ item.id }}">
                                        <option value="" selected>Не выбран</option>
                                        {% for user in supplier_users %}
                                            <option value="{{ user.role_id }}|{{ user.role }}">
                                                {{ user.username }} ({{ user.role == 'manager' ? 'Менеджер' : 'Клиент' }})
                                            </option>
                                        {% endfor %}
                                    </select>
                                </td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        {% endif %}

        <!-- Раздел: Деньги, отправленные на поставщика -->
        {% if companies is not empty %}
            <div class="bg-white shadow-sm rounded-2xl p-6 border border-gray-100 mt-8">
                <h2 class="text-2xl font-semibold text-gray-800 mb-6">
                    Список компаний поставщика
                </h2>

                <!-- Сетка компаний: по две карточки -->
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
                    {% for company in companies %}
                        <div class="flex flex-col justify-between border rounded-2xl p-5 bg-gray-50 hover:bg-gray-100 transition shadow-sm w-full">
                            <!-- Информация о компании -->
                            <div class="space-y-2">
                                <div>
                                    <div class="text-sm text-gray-500">Компания</div>
                                    <div class="text-lg font-semibold text-gray-800 break-words">
                                        {{ company.company_name }}
                                    </div>
                                </div>
                                <div>
                                    <div class="text-sm text-gray-500">Банк</div>
                                    <div class="text-base text-gray-700 break-words">
                                        {{ company.bank_name }}
                                    </div>
                                </div>
                                <div>
                                    <div class="text-sm text-gray-500">INN</div>
                                    <div class="text-base text-gray-700 break-words">
                                        {{ company.inn }}
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </div>
        {% else %}
            <div class="bg-white shadow-sm rounded-2xl p-6 border border-gray-100 mt-8 text-center text-gray-500">
                У поставщика нет компаний для отображения.
            </div>
        {% endif %}
    </div>

    <!-- Модалки ошибок и успеха -->
    <dialog id="errorModal" class="modal">
        <div class="modal-box">
            <h3 class="text-lg font-bold">Ошибка!</h3>
            <p id="errorText" class="py-4"></p>
            <div class="modal-action">
                <form method="dialog">
                    <button class="btn">Закрыть</button>
                </form>
            </div>
        </div>
    </dialog>

    <!-- Триггер через checkbox -->
    <input type="checkbox" id="notifications" class="hidden peer"/>
    <div class="fixed bottom-4 right-4 z-50 max-w-sm w-full
            hidden peer-checked:flex flex-col bg-white border border-gray-300 rounded-xl shadow-xl
            animate-fade-in transition-opacity duration-300 ease-out
            px-5 py-4 space-y-2">

        <div class="flex items-start justify-between">
            <div class="flex items-start space-x-2">
                <svg class="w-6 h-6 text-blue-500 mt-1 shrink-0" fill="none" stroke="currentColor" stroke-width="1.5"
                     viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round"
                          d="M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022 23.85 23.85 0 0 0 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0 3 3 0 1 0 5.714 0ZM3.124 7.5A8.969 8.969 0 0 1 5.292 3m13.416 0a8.969 8.969 0 0 1 2.168 4.5"/>
                </svg>

                <div>
                    <h3 class="text-base font-semibold text-gray-900">Уведомление</h3>
                    <p id="notifications-txt" class="text-sm text-gray-600 leading-snug mt-1">...</p>
                </div>
            </div>

            <label for="notifications" class="text-gray-400 hover:text-gray-600 transition cursor-pointer">
                ✕
            </label>
        </div>
    </div>


    <!-- Модальное окно распределения товарных денег -->
    <input type="checkbox" id="save_expense_modal" class="modal-toggle"/>
    <div class="modal">
        <div class="modal-box relative rounded-2xl p-6 sm:p-8 w-full max-w-md">
            <h3 class="text-xl sm:text-2xl font-semibold text-green-800 mb-6 text-center">
                Распоряжение товарными деньгами
            </h3>

            <div class="space-y-4">
                <!-- Назначение -->
                <div>
                    <p class="text-sm font-medium text-gray-700 mb-1">Назначение</p>
                    <div id="modal-purpose" class="text-black font-semibold text-base break-words"></div>
                </div>

                <div>
                    <p class="text-sm font-medium text-gray-700 mb-1">Назначение (детали)</p>
                    <div id="modal-appointment"
                         class="text-black font-semibold text-base break-words border border-green-300 rounded-lg px-3 py-2 bg-white"></div>
                </div>

                <!-- Сумма -->
                <div>
                    <p class="text-sm font-medium text-gray-700 mb-1">Сумма</p>
                    <div id="modal-balance"
                         class="text-black font-bold text-lg border border-green-300 rounded-lg px-3 py-2 bg-white"></div>
                </div>

                <!-- Дата -->
                <div>
                    <p class="text-sm font-medium text-gray-700 mb-1">Дата</p>
                    <div id="modal-date"
                         class="text-black font-bold text-lg border border-green-300 rounded-lg px-3 py-2 bg-white"></div>
                </div>


                <!-- Комментарий -->
                <div>
                    <p class="text-sm font-medium text-gray-700 mb-1">Комментарий</p>
                    <textarea readonly id="modal-comments"
                              class="w-full rounded-lg border border-green-300 text-black px-3 py-2 text-sm sm:text-base outline-none focus:outline-none bg-white"
                              rows="3"></textarea>
                </div>
            </div>

            <!-- Кнопки -->
            <div class="flex justify-end gap-3 mt-6">
                <label for="save_expense_modal"
                       class="btn btn-ghost px-5 py-2 text-gray-800 border border-green-300 rounded-lg hover:bg-green-50 transition">
                    Отмена
                </label>
                <button id="confirmExpense"
                        class="btn bg-green-600 hover:bg-green-700 text-white border-none px-6 py-2 rounded-lg transition">
                    Подтвердить
                </button>
            </div>
        </div>
    </div>


    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pikaday/css/pikaday.css">
    <script src="https://cdn.jsdelivr.net/npm/pikaday/pikaday.js"></script>


    <script>

        document.addEventListener('DOMContentLoaded', function() {

            document.querySelectorAll('.datepicker_from, .datepicker_to, .datepicker_from_stock').forEach(field => {
                new Pikaday({
                    field: field,
                    format: 'DD.MM.YYYY',
                    firstDay: 1,
                    bound: true,         // привязка к input
                    reposition: true,    // автопозиционирование
                    container: field.parentElement, // добавляем внутри родителя, чтобы flex не ломал позицию
                    i18n: {
                        previousMonth: 'Предыдущий',
                        nextMonth: 'Следующий',
                        months: ['Январь', 'Февраль', 'Март', 'Апрель', 'Май', 'Июнь', 'Июль', 'Август', 'Сентябрь', 'Октябрь', 'Ноябрь', 'Декабрь'],
                        weekdays: ['Воскресенье', 'Понедельник', 'Вторник', 'Среда', 'Четверг', 'Пятница', 'Суббота'],
                        weekdaysShort: ['Вс', 'Пн', 'Вт', 'Ср', 'Чт', 'Пт', 'Сб']
                    },
                    toString(date) {
                        const day = String(date.getDate()).padStart(2, '0');
                        const month = String(date.getMonth() + 1).padStart(2, '0');
                        const year = date.getFullYear();
                        return `${day}.${month}.${year}`;
                    },
                    parse(dateString) {
                        const parts = dateString.split('.');
                        const day = parseInt(parts[0], 10);
                        const month = parseInt(parts[1], 10) - 1;
                        const year = parseInt(parts[2], 10);
                        return new Date(year, month, day);
                    }
                });
            });

            function showCornerModal(message) {
                const checkbox = document.getElementById('notifications');
                const txtModal = document.getElementById('notifications-txt');
                checkbox.checked = true;
                txtModal.innerHTML = message;
                setTimeout(() => {
                    checkbox.checked = false;
                }, 5000);
            }

            document.querySelectorAll('.search-sending-to-supplier').forEach(btn => {
                btn.addEventListener('click', () => {
                    const dateFrom = document.getElementById('from');
                    const dateTo = document.getElementById('to');


                    if (!dateFrom.value && !dateTo.value) {
                        showCornerModal('Выберите фильтр');
                        return;
                    }


                    if (!dateFrom.value && dateTo.value) {
                        showCornerModal('Выберите начало даты!');
                        return;
                    }

                    const params = new URLSearchParams();
                    if (dateFrom.value) params.append('date_from', dateFrom.value);
                    if (dateTo.value)   params.append('date_to', dateTo.value);

                    window.location.href = `/supplier/getTransactionDate?${params.toString()}`;
                });
            });

            // -----------------------------------
            // Универсальная функция для ошибок
            // -----------------------------------
            const openErrorModal = (message) => {
                const errorModal = document.getElementById('errorModal');
                const errorText = document.getElementById('errorText');
                if (errorModal && errorText) {
                    errorText.textContent = message;
                    errorModal.showModal();
                }
            };

            // -----------------------------------
            // Отправка товарных денег
            // -----------------------------------
            const commentsModal = document.getElementById('modal-comments');
            const modalBalance = document.getElementById('modal-balance');
            const modalPurpose = document.getElementById('modal-purpose');
            const modalAppointment = document.getElementById('modal-appointment');

            const modalDate = document.getElementById('modal-date');
            const dateInput = document.getElementById('date_input_stokc');
            let post = null;

            document.getElementById('save_expense').addEventListener('click', () => {
                const selectedRadio = document.querySelector('input[name="delivery_type"]:checked');
                const balanceInput = document.getElementById('balance');
                const enteredValue = balanceInput && typeof balanceInput.value !== 'undefined'
                    ? balanceInput.value.trim()
                    : '';
                const amount = Number(enteredValue);
                let categoryPath = '';
                const dateValue = dateInput.value.trim();

                if (!enteredValue || isNaN(Number(enteredValue)) || Number(enteredValue) <= 0) {
                    openErrorModal('Укажите корректную сумму!');
                    return;
                }

                if (!dateValue) {
                    openErrorModal('Укажите дату!');
                    return;
                }

                if (!selectedRadio) {
                    openErrorModal('Выберите назначение!');
                    return;
                }


                const deliveryType = selectedRadio.value;
                let selectedId = null;
                let userName = null;

                if (deliveryType === 'courier') {
                    const courierInput = document.querySelector('input[name="courier_id"]');
                    const userinput = document.querySelector('input[name="courier_name"]');
                    if (courierInput && courierInput.value) {
                        selectedId = courierInput.value;
                        userName = userinput.value;
                    } else {
                        openErrorModal('Выберите курьера!');
                        return;
                    }
                } else if (deliveryType === 'client') {
                    const clientInput = document.querySelector('input[name="client_id"]');
                    const userinput = document.querySelector('input[name="client_name"]');

                    if (clientInput && clientInput.value) {
                        selectedId = clientInput.value;
                        userName = userinput.value;
                    } else {
                        openErrorModal('Выберите клиента!');
                        return;
                    }
                } else if (deliveryType === 'expense') {
                    const categoryElement = document.getElementById('category');
                    categoryPath = categoryElement ? categoryElement.textContent.trim() : '';
                    if (!categoryPath) {
                        openErrorModal('Выберите категорию назначения!');
                        return;
                    }

                    userName = categoryPath;
                }

                const commentsTextarea = document.getElementById('comments');
                const commentValue = commentsTextarea ? commentsTextarea.value.trim() : '';
                if (!commentValue) {
                    openErrorModal('Введите комментарий!');
                    return;
                }

                const purpose = {
                    courier: 'Курьеру',
                    client: 'Клиенту',
                    supplier: 'Поставщику',
                    client_services: 'Клиент услуги',
                    expense: 'Расход',
                    debt: 'Закрытие долга компании',
                };

                post = {
                    delivery_type: deliveryType,
                    selected_id: selectedId,
                    category_path: categoryPath,
                    amount: amount || 0,
                    comments: commentValue,
                    date: dateValue,
                }

                if (deliveryType === 'debt') {
                    userName = 'Долг компании'
                }

                modalPurpose.textContent = purpose[deliveryType] || 'Не известно';
                modalAppointment.textContent = userName || 'Не известно';
                modalBalance.textContent = amount || 0;
                commentsModal.textContent = commentValue;
                modalDate.textContent = dateValue;
                document.getElementById('save_expense_modal').checked = true;
            });

            document.getElementById('confirmExpense').addEventListener('click', async () => {

                if (!post) {
                    openErrorModal('Ошибка сбора данных!');
                    return;
                }

                const result = await postDataRes('/supplier/definitionCommodityMoney', post);


                document.getElementById('save_expense_modal').checked = false;

                if (result === 'error') {
                    openErrorModal('Ошибка при отправке данных!');
                    return;
                }

                if (result.success) {
                    location.reload();
                } else {
                    openErrorModal('Не удалось обработать запрос!');
                }
            });
        });

    </script>

    <style>
        /* Центрирование модального окна */
        #confirm_manager_modal::backdrop {
            background-color: rgba(0,0,0,0.4);
        }

        #confirm_manager_modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            max-height: 90vh;
            overflow-y: auto;
        }

    </style>



{% endblock %}